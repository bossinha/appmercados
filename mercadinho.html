<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>Mercadinho Online</title>
<style>
  body {
    font-family: 'Poppins', sans-serif;
    margin: 0;
    padding: 0;
    background: transparent;
    color: #222;
  }

  header {
    text-align: center;
    padding: 1rem;
    background: rgba(255,255,255,0.9);
    backdrop-filter: blur(5px);
    box-shadow: 0 2px 8px rgba(0,0,0,0.1);
    position: sticky;
    top: 0;
    z-index: 10;
  }

  header h1 {
    color: #2e7d32;
    margin: 0;
  }

  .banner {
    width: 100%;
    overflow: hidden;
    border-radius: 12px;
    margin: 1rem auto;
  }

  .banner img {
    width: 100%;
    border-radius: 12px;
  }

  main {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(180px, 1fr));
    gap: 1rem;
    padding: 1rem;
  }

  .card {
    background: rgba(255,255,255,0.9);
    backdrop-filter: blur(6px);
    border-radius: 16px;
    box-shadow: 0 4px 10px rgba(0,0,0,0.08);
    padding: 1rem;
    text-align: center;
    transition: transform 0.2s;
  }
  .card:hover { transform: scale(1.02); }

  .card img {
    width: 100%;
    height: 140px;
    object-fit: cover;
    border-radius: 12px;
  }

  .price { color: #2e7d32; font-weight: bold; margin: 0.5rem 0; }

  button {
    background: #2e7d32;
    color: #fff;
    border: none;
    padding: 0.6rem 1rem;
    border-radius: 10px;
    cursor: pointer;
    transition: background 0.2s;
  }
  button:hover { background: #256628; }

  #cart {
    background: rgba(255,255,255,0.9);
    backdrop-filter: blur(5px);
    padding: 1rem;
    border-radius: 16px;
    box-shadow: 0 2px 10px rgba(0,0,0,0.1);
    margin: 1rem;
  }

  .admin-panel {
    display: none;
    background: rgba(255,255,255,0.95);
    padding: 1rem;
    border-radius: 16px;
    margin: 1rem;
  }

  input, textarea {
    width: 100%;
    padding: 0.5rem;
    margin: 0.5rem 0;
    border-radius: 8px;
    border: 1px solid #ccc;
  }

  .login-admin {
    text-align: center;
    margin-top: 1rem;
  }
</style>
</head>
<body>
  <header>
    <h1>Mercadinho Online</h1>
  </header>

  <div class="banner">
    <img id="bannerImage" src="https://via.placeholder.com/800x250?text=Ofertas+da+Semana" alt="Banner">
  </div>

  <main id="productList"></main>

  <section id="cart">
    <h2>Carrinho</h2>
    <ul id="cartItems"></ul>
    <label><input type="checkbox" id="deliveryOption"> Precisa de entrega?</label><br>
    <p><strong>Total: R$ <span id="totalPrice">0.00</span></strong></p>
    <button id="checkoutBtn">Finalizar Pedido</button>
  </section>

  <div class="login-admin">
    <button onclick="loginAdmin()">ðŸ”‘ Entrar como Administrador</button>
  </div>

  <div class="admin-panel" id="adminPanel">
    <h2>Painel do Administrador</h2>

    <h3>Adicionar Produto</h3>
    <input type="text" id="prodName" placeholder="Nome do Produto">
    <textarea id="prodDesc" placeholder="DescriÃ§Ã£o"></textarea>
    <input type="number" id="prodPrice" placeholder="PreÃ§o">
    <input type="file" id="prodImage" accept="image/*">
    <button onclick="addProduct()">Salvar Produto</button>

    <h3>Alterar Banner</h3>
    <input type="file" id="bannerInput" accept="image/*">
    <button onclick="changeBanner()">Atualizar Banner</button>

    <h3>ConfiguraÃ§Ãµes</h3>
    <label>Taxa de Entrega (R$): <input type="number" id="deliveryFee" value="5"></label><br>
    <label>NÃºmero do WhatsApp: <input type="text" id="whatsappNumber" placeholder="Ex: +55 85 9XXXX-XXXX"></label><br>
    <button onclick="saveSettings()">Salvar ConfiguraÃ§Ãµes</button>

    <h3>Gerenciar Produtos</h3>
    <ul id="adminProducts"></ul>
  </div>

<script>
  let products = JSON.parse(localStorage.getItem('products') || '[]');
  let cart = [];
  let deliveryFee = parseFloat(localStorage.getItem('deliveryFee') || 5);
  let whatsappNumber = localStorage.getItem('whatsappNumber') || '';

  const productList = document.getElementById('productList');
  const cartItems = document.getElementById('cartItems');
  const totalPriceEl = document.getElementById('totalPrice');
  const adminPanel = document.getElementById('adminPanel');

  function renderProducts() {
    productList.innerHTML = '';
    products.forEach((p, i) => {
      const card = document.createElement('div');
      card.className = 'card';
      card.innerHTML = `
        <img src="${p.image}" alt="${p.name}">
        <h3>${p.name}</h3>
        <p>${p.desc}</p>
        <p class='price'>R$ ${p.price.toFixed(2)}</p>
        <button onclick='addToCart(${i})'>Adicionar</button>
      `;
      productList.appendChild(card);
    });
  }

  function renderAdminProducts() {
    const adminList = document.getElementById('adminProducts');
    adminList.innerHTML = '';
    products.forEach((p, i) => {
      const li = document.createElement('li');
      li.textContent = `${p.name} - R$ ${p.price.toFixed(2)}`;
      const delBtn = document.createElement('button');
      delBtn.textContent = 'Excluir';
      delBtn.onclick = () => {
        products.splice(i, 1);
        localStorage.setItem('products', JSON.stringify(products));
        renderProducts();
        renderAdminProducts();
      };
      li.appendChild(delBtn);
      adminList.appendChild(li);
    });
  }

  function addProduct() {
    const name = document.getElementById('prodName').value;
    const desc = document.getElementById('prodDesc').value;
    const price = parseFloat(document.getElementById('prodPrice').value);
    const imgInput = document.getElementById('prodImage');

    if (!name || !price || !imgInput.files[0]) {
      alert('Preencha nome, preÃ§o e imagem');
      return;
    }

    const reader = new FileReader();
    reader.onload = e => {
      const newProduct = { name, desc, price, image: e.target.result };
      products.push(newProduct);
      localStorage.setItem('products', JSON.stringify(products));
      renderProducts();
      renderAdminProducts();
      document.getElementById('prodName').value = '';
      document.getElementById('prodDesc').value = '';
      document.getElementById('prodPrice').value = '';
      imgInput.value = '';
    };
    reader.readAsDataURL(imgInput.files[0]);
  }

  function addToCart(index) {
    cart.push(products[index]);
    renderCart();
  }

  function renderCart() {
    cartItems.innerHTML = '';
    let total = 0;
    cart.forEach((p, i) => {
      total += p.price;
      const li = document.createElement('li');
      li.textContent = `${p.name} - R$ ${p.price.toFixed(2)}`;
      cartItems.appendChild(li);
    });

    if (document.getElementById('deliveryOption').checked) {
      total += deliveryFee;
    }

    totalPriceEl.textContent = total.toFixed(2);
  }

  document.getElementById('deliveryOption').addEventListener('change', renderCart);

  document.getElementById('checkoutBtn').addEventListener('click', () => {
    if (!whatsappNumber) {
      alert('Configure o nÃºmero do WhatsApp no painel admin primeiro!');
      return;
    }
    let message = 'ðŸ›’ *Pedido:*%0A';
    cart.forEach(p => message += `- ${p.name} - R$ ${p.price.toFixed(2)}%0A`);
    if (document.getElementById('deliveryOption').checked) {
      message += `%0AðŸšš Entrega: R$ ${deliveryFee.toFixed(2)}`;
    }
    message += `%0A%0ATotal: R$ ${totalPriceEl.textContent}`;
    window.open(`https://wa.me/${whatsappNumber.replace(/\D/g,'')}?text=${message}`, '_blank');
  });

  function loginAdmin() {
    const senha = prompt('Digite a senha de administrador:');
    if (senha === 'bossainfor123') {
      adminPanel.style.display = 'block';
      renderAdminProducts();
    } else {
      alert('Senha incorreta!');
    }
  }

  function changeBanner() {
    const bannerInput = document.getElementById('bannerInput');
    if (!bannerInput.files[0]) return;
    const reader = new FileReader();
    reader.onload = e => {
      document.getElementById('bannerImage').src = e.target.result;
      localStorage.setItem('banner', e.target.result);
    };
    reader.readAsDataURL(bannerInput.files[0]);
  }

  function saveSettings() {
    deliveryFee = parseFloat(document.getElementById('deliveryFee').value);
    whatsappNumber = document.getElementById('whatsappNumber').value;
    localStorage.setItem('deliveryFee', deliveryFee);
    localStorage.setItem('whatsappNumber', whatsappNumber);
    alert('ConfiguraÃ§Ãµes salvas!');
  }

  window.onload = () => {
    const banner = localStorage.getItem('banner');
    if (banner) document.getElementById('bannerImage').src = banner;
    renderProducts();
  }
</script>
</body>
</html>
